import{f as e,J as n,K as a,u as i,N as t,L as l,z as c,m as s,_ as r,e as o,U as u,Q as p,F as d,V as _,p as m,W as v,a as f,g as h,X as g}from"./main-DEr_vuYN.js";import{B as w,I as N}from"./Icon-CI6KpGeD.js";const z={tags:"_tags_c0lwc_1",empty:"_empty_c0lwc_10"},y={tag:"_tag_giprq_1",place:"_place_giprq_12",name:"_name_giprq_46",score:"_score_giprq_53",selected:"_selected_giprq_57"};function b({tag:l}){const c=e(n),s=[y.tag,l.name===c.selectedTag.value?y.selected:""].join(" "),r=e(a);return i("button",{className:s,onClick:function(){r.isAuthenticated.value&&(c.selectAndFetch(l.name),t.addNotification({type:"success",title:"Смена сторны",message:`Теперь вы воюеете за ${l.name}`}))},children:[i("p",{className:y.place,children:l.place+1}),i("p",{className:y.name,children:l.name}),i("p",{className:y.score,children:-1===l.pixels?"??":l.pixels})]})}const k={window:"_window_2hefc_1","scale-up":"_scale-up_2hefc_1","scale-down":"_scale-down_2hefc_1",content:"_content_2hefc_46",title:"_title_2hefc_47"};function x({children:e,title:n}){return i("details",{className:k.window,children:[i("summary",{className:k.title,children:n}),i("div",{className:k.content,children:e})]})}const I={input:"_input_1ptyx_1"};function j({placeholder:e,onInput:n,min:a,max:t,type:l="text",defaultValue:c,value:s}){return i("input",{type:l,className:I.input,value:s,placeholder:e,onInput:e=>n(e.currentTarget.value),defaultValue:c,minLength:a,maxLength:t,min:a,max:t})}const S=l(!1),T={form:"_form_1s9ls_1",closeIcon:"_closeIcon_1s9ls_7"};function A(){const a=e(n),[l,s]=c("");return i("div",{className:T.form,children:[i(j,{placeholder:"Передумай",onInput:s,min:4,max:8}),i(w,{onClick:function(){""!==l&&(a.selectAndFetch(l),t.addNotification({type:"success",title:"Пришитие",message:`Теперь вы воюеете за ${l}`}),S.value=!1)},children:i(N,{icon:"plus"})}),i(w,{onClick:function(){S.value=!1},type:"danger",children:i(N,{icon:"plus",className:T.closeIcon})})]})}const D={form:"_form_zsgc1_1"};function C(){const a=e(n);return i("div",{className:D.form,children:[i(w,{onClick:function(){S.value=!0},children:"Пришиться"}),i(w,{onClick:function(){var e;(null==(e=s.user.value)?void 0:e.tag)&&(a.remove(),t.addNotification({type:"success",title:"Отшитие",message:"Теперь вы воюете ни за кого"}))},type:"danger",children:"Отшиться"})]})}function q(){const[t,l]=c(),s=e(n),u=e(a);return r((()=>{s.fetch();const e=setInterval(s.fetch,o.time.update.tags);l(e)}),[]),i(x,{title:"Группировки",children:i("div",{className:z.tags,children:[0===s.tags.value.length?i("p",{className:z.empty,children:"Даже перекати-поля нет..."}):s.tags.value.map(((e,n)=>i(b,{tag:e},e.name))),u.isAuthenticated.value?S.value?i(A,{}):i(C,{}):null]})})}const V={sidebar:"_sidebar_1efu7_1"},B={login:"_login_1e9cb_1",params:"_params_1e9cb_6",wrapper:"_wrapper_1e9cb_14"},L={wrapper:"_wrapper_zckff_1",label:"_label_zckff_7",value:"_value_zckff_11"};function O({label:e,value:n}){return i("div",{className:L.wrapper,children:[i("p",{className:L.label,children:e}),i("p",{className:L.value,children:n})]})}function U(){var t,l,c,s,o,p,d,_;const m=e(a),v=e(n);r((()=>{m.load(),m.isAuthenticated.value&&m.fetch().then((()=>{var e;return v.select((null==(e=m.user.value)?void 0:e.tag)??"")}))}),[]);const f={"ФИО":null==(t=m.user.value)?void 0:t.username,"Серия и номер":null==(l=m.user.value)?void 0:l.userID,"Группировка":null==(c=m.user.value)?void 0:c.tag,"Статус":{[u.User]:null,[u.Moderator]:"Мондиратор",[u.Admin]:"Одмэн"}[(null==(s=m.user.value)?void 0:s.role)??u.User],"Судимость":(null==(o=m.user.value)?void 0:o.banned)?(null==(p=m.user.value)?void 0:p.banned.reason)??"Не указана":null,"Соц. рейтинг":(null==(d=m.user.value)?void 0:d.points)||0};return console.log(null==(_=m.user.value)?void 0:_.points.toString()),m.isAuthenticated.value?i(x,{title:"Паспорт",children:i("div",{class:B.wrapper,children:[i("div",{className:B.params,children:Object.entries(f).map((([e,n])=>n||0===n?i(O,{value:n.toString(),label:e}):null))}),i(w,{href:"/logout",children:"Выпилиться"})]})}):i("div",{class:B.login,children:i(w,{href:"/login",children:"Впилиться"})})}const F={notifications:"_notifications_64rx3_1"},M={notification:"_notification_10kz6_1","add-notification":"_add-notification_10kz6_1",title:"_title_10kz6_24",message:"_message_10kz6_29",success:"_success_10kz6_42",error:"_error_10kz6_46",animate:"_animate_10kz6_50","remove-notification":"_remove-notification_10kz6_1"};function X({notification:e}){const[n,a]=c(""),[l,s]=c(setTimeout((()=>{}),0));return r((()=>{s(setTimeout((()=>{a(M.animate),setTimeout((()=>t.removeNotification(e.id)),200)}),o.time.notificationRemoved))}),[]),i("div",{className:[M.notification,M[e.type],n].join(" "),children:[i("p",{className:M.title,children:e.title}),i("p",{className:M.message,children:e.message})]})}function $(){const n=e(p);return i("div",{className:F.notifications,children:n.notifications.value.map(((e,n)=>i(X,{notification:e},e.id)))})}const E={wrapper:"_wrapper_16c0i_1",wrapperActive:"_wrapperActive_16c0i_11",input:"_input_16c0i_15",or:"_or_16c0i_19",label:"_label_16c0i_23"};function J(){const n=d(null),[a,t]=c(!1),l=e(_),s=e(m),r=e(p);async function o(e){const n=new v(await e.arrayBuffer(),4);await n.process();s.image.value.size.x<n.size.x||s.image.value.size.y<n.size.y?r.addNotification({title:"О нет, он такой большой...",message:"Картинка больше холста",type:"error"}):l.setImage(n,e.name,new f(0,0))}function u(e){e.preventDefault(),t(!0)}function h(e){e.preventDefault(),t(!1)}return i("div",{class:[E.wrapper,a?E.wrapperActive:""].join(" "),onDrop:function(e){var n;e.preventDefault(),h(e);const a=null==(n=e.dataTransfer)?void 0:n.files;a&&a.length&&o(a[0])},onDragEnter:u,onDragOver:u,onDragLeave:h,children:[i("p",{class:E.label,children:"Кладите деньги"}),i("p",{class:E.or,children:"или"}),i("input",{type:"file",accept:"image/*",onInput:function(e){e.preventDefault();const n=e.currentTarget.files;n&&n.length&&o(n[0])},ref:n,class:E.input}),i(w,{onClick:()=>{var e;return null==(e=n.current)?void 0:e.click()},children:"Взломать компьютер"})]})}const K={coordinates:"_coordinates_1cczs_1",groups:"_groups_1cczs_7",group:"_group_1cczs_7",groupTitle:"_groupTitle_1cczs_20",wrapper:"_wrapper_1cczs_28",image:"_image_1cczs_34",imageName:"_imageName_1cczs_40",removeIcon:"_removeIcon_1cczs_49"};function Q(){var n,a;const t=e(_),l=e(m);function c(e,n){const a=t.position.value.clone();a[e]=n,t.position.value=a,t.save()}return i("div",{class:K.wrapper,children:[i("div",{class:K.image,children:[i("p",{class:K.imageName,children:t.imageName}),i(w,{onClick:t.unsetImage,type:"danger",children:i(N,{icon:"plus",className:K.removeIcon})})]}),i("div",{class:K.groups,children:[i("div",{class:K.group,children:[i("p",{class:K.groupTitle,children:"Какие то циферки"}),i("div",{class:K.coordinates,children:[i(j,{min:0,max:null==(n=l.image.value)?void 0:n.size.x,type:"number",placeholder:"X пукалка",defaultValue:t.position.value.x.toString(),onInput:e=>c("x",parseInt(e))}),i(j,{min:0,max:null==(a=l.image.value)?void 0:a.size.y,type:"number",placeholder:"Y пукалка",defaultValue:t.position.value.y.toString(),onInput:e=>c("y",parseInt(e))})]})]}),i("div",{class:K.group,children:[i("p",{class:K.groupTitle,children:"Дымность"}),i(j,{min:0,max:100,type:"number",placeholder:"Дымность",defaultValue:t.opacity.value.toString(),onInput:function(e){t.opacity.value=parseInt(e),t.save()}})]})]})]})}function R(){const n=e(_);return r((()=>{n.load()}),[]),i(x,{title:"Срисовать",children:n.isSet.value?i(Q,{}):i(J,{})})}function W(){return i("div",{className:V.sidebar,children:[i(U,{}),i(q,{}),i(R,{}),i($,{})]})}const Y={wrapper:"_wrapper_157jp_1","scale-down":"_scale-down_157jp_1","scale-up":"_scale-up_157jp_1",content:"_content_157jp_39",title:"_title_157jp_40",params:"_params_157jp_49",media:"_media_157jp_57",icons:"_icons_157jp_82"},G={wrapper:"_wrapper_u7e1h_1",input:"_input_u7e1h_7"};function H(){if(![11,0,1].includes((new Date).getMonth()))return null;const n=e(h);return i("div",{className:G.wrapper,children:[i("input",{type:"checkbox",className:G.input,onChange:function(e){n.settings.value={...n.settings.value,enableSnow:e.target.checked},n.save()},defaultChecked:n.settings.value.enableSnow}),i(N,{icon:"snowflake",alt:"Переключить снег",size:35,viewBoxSize:272})]})}function P(){const n=e(g),a=e(m),[t,l]=c();if(r((()=>{n.fetch(),l(setInterval(n.fetch,o.time.update.info))}),[]),null===n.info.value||null===a.image.value)return null;const s=n.info.value.ended,u="season:blank"===n.info.value.name?"Без названия":n.info.value.name,p=s?"🏁":"⚔️";return i("details",{className:Y.wrapper,children:[i("summary",{className:Y.title,children:[u," ",p]}),i("div",{className:Y.content,children:[i("div",{className:Y.params,children:[i(O,{label:"Подожди",value:n.info.value.cooldown+"мс"}),i(O,{label:"Пропорция",value:a.image.value.size.x+"x"+a.image.value.size.y}),i(O,{label:"Офлайн",value:n.info.value.online.toString()})]}),i("div",{className:Y.icons,children:[i("div",{className:Y.media,children:Object.entries(o.media).map((([e,n])=>i("a",{href:n[0],target:"_blank",rel:"noopener noreferrer",children:i(N,{icon:e,alt:n[1],size:35,viewBoxSize:256})},e)))}),i(H,{})]})]})]})}const Z="_wrapper_udxdq_1";function ee(){return i("div",{className:Z,children:[i(P,{}),i(W,{})]})}export{ee as TopBar};
