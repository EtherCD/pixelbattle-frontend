import{f as e,J as n,K as a,u as i,N as t,L as l,z as c,m as s,_ as r,e as o,U as u,Q as p,F as _,V as d,p as m,W as v,a as f,g,X as h}from"./main-XM7eXcqa.js";import{B as w,I as N}from"./Icon-Ci2mgG_g.js";const z={tags:"_tags_c0lwc_1",empty:"_empty_c0lwc_10"},y={tag:"_tag_giprq_1",place:"_place_giprq_12",name:"_name_giprq_46",score:"_score_giprq_53",selected:"_selected_giprq_57"};function b({tag:l}){const c=e(n),s=[y.tag,l.name===c.selectedTag.value?y.selected:""].join(" "),r=e(a);return i("button",{className:s,onClick:function(){r.isAuthenticated.value&&(c.selectAndFetch(l.name),t.addNotification({type:"success",title:"Изменение тега",message:`Ваш новый тег: ${l.name}`}))},children:[i("p",{className:y.place,children:l.place+1}),i("p",{className:y.name,children:l.name}),i("p",{className:y.score,children:-1===l.pixels?"??":l.pixels})]})}const x={window:"_window_m8ewx_1","scale-up":"_scale-up_m8ewx_1","scale-down":"_scale-down_m8ewx_1",content:"_content_m8ewx_46",title:"_title_m8ewx_47"};function k({children:e,title:n}){return i("details",{className:x.window,children:[i("summary",{className:x.title,children:n}),i("div",{className:x.content,children:e})]})}const I={input:"_input_1ptyx_1"};function j({placeholder:e,onInput:n,min:a,max:t,type:l="text",defaultValue:c,value:s}){return i("input",{type:l,className:I.input,value:s,placeholder:e,onInput:e=>n(e.currentTarget.value),defaultValue:c,minLength:a,maxLength:t,min:a,max:t})}const T=l(!1),A={form:"_form_1s9ls_1",closeIcon:"_closeIcon_1s9ls_7"};function D(){const a=e(n),[l,s]=c("");return i("div",{className:A.form,children:[i(j,{placeholder:"Новый тег",onInput:s,min:4,max:8}),i(w,{onClick:function(){""!==l&&(a.selectAndFetch(l),t.addNotification({type:"success",title:"Изменение тега",message:`Ваш новый тег: ${l}`}),T.value=!1)},children:i(N,{icon:"plus"})}),i(w,{onClick:function(){T.value=!1},type:"danger",children:i(N,{icon:"plus",className:A.closeIcon})})]})}const C={form:"_form_zsgc1_1"};function S(){const a=e(n);return i("div",{className:C.form,children:[i(w,{onClick:function(){T.value=!0},children:"Новый тег"}),i(w,{onClick:function(){var e;(null==(e=s.user.value)?void 0:e.tag)&&(a.remove(),t.addNotification({type:"success",title:"Изменение тега",message:"Тег был сброшен"}))},type:"danger",children:"Убрать текущий"})]})}function q(){const[t,l]=c(),s=e(n),u=e(a);return r((()=>{s.fetch();const e=setInterval(s.fetch,o.time.update.tags);l(e)}),[]),i(k,{title:"Теги",children:i("div",{className:z.tags,children:[0===s.tags.value.length?i("p",{className:z.empty,children:"Нет тегов"}):s.tags.value.map(((e,n)=>i(b,{tag:e},e.name))),u.isAuthenticated.value?T.value?i(D,{}):i(S,{}):null]})})}const V={sidebar:"_sidebar_1efu7_1"},B={login:"_login_1e9cb_1",params:"_params_1e9cb_6",wrapper:"_wrapper_1e9cb_14"},L={wrapper:"_wrapper_zckff_1",label:"_label_zckff_7",value:"_value_zckff_11"};function O({label:e,value:n}){return i("div",{className:L.wrapper,children:[i("p",{className:L.label,children:e}),i("p",{className:L.value,children:n})]})}function U(){var t,l,c,s,o,p;const _=e(a),d=e(n);r((()=>{_.load(),_.isAuthenticated.value&&_.fetch().then((()=>{var e;return d.select((null==(e=_.user.value)?void 0:e.tag)??"")}))}),[]);const m={"Имя":null==(t=_.user.value)?void 0:t.username,"Айди":null==(l=_.user.value)?void 0:l.userID,"Тег":null==(c=_.user.value)?void 0:c.tag,"Статус":(null==(s=_.user.value)?void 0:s.banned)?`Забанен по причине "${(null==(o=_.user.value)?void 0:o.banned.reason)??"Не указано"}"`:null,"Роль":{[u.User]:null,[u.Moderator]:"Модератор",[u.Admin]:"Админ"}[(null==(p=_.user.value)?void 0:p.role)??u.User]};return _.isAuthenticated.value?i(k,{title:"Профиль",children:i("div",{class:B.wrapper,children:[i("div",{className:B.params,children:Object.entries(m).map((([e,n])=>n?i(O,{value:n,label:e}):null))}),i(w,{href:"/logout",children:"Выйти"})]})}):i("div",{class:B.login,children:i(w,{href:"/login",children:"Войти"})})}const $={notifications:"_notifications_64rx3_1"},F={notification:"_notification_10kz6_1","add-notification":"_add-notification_10kz6_1",title:"_title_10kz6_24",message:"_message_10kz6_29",success:"_success_10kz6_42",error:"_error_10kz6_46",animate:"_animate_10kz6_50","remove-notification":"_remove-notification_10kz6_1"};function M({notification:e}){const[n,a]=c(""),[l,s]=c(setTimeout((()=>{}),0));return r((()=>{s(setTimeout((()=>{a(F.animate),setTimeout((()=>t.removeNotification(e.id)),200)}),o.time.notificationRemoved))}),[]),i("div",{className:[F.notification,F[e.type],n].join(" "),children:[i("p",{className:F.title,children:e.title}),i("p",{className:F.message,children:e.message})]})}function X(){const n=e(p);return i("div",{className:$.notifications,children:n.notifications.value.map(((e,n)=>i(M,{notification:e},e.id)))})}const E={wrapper:"_wrapper_16c0i_1",wrapperActive:"_wrapperActive_16c0i_11",input:"_input_16c0i_15",or:"_or_16c0i_19",label:"_label_16c0i_23"};function J(){const n=_(null),[a,t]=c(!1),l=e(d),s=e(m),r=e(p);async function o(e){const n=new v(await e.arrayBuffer(),4);s.image.value.size.x<n.size.x||s.image.value.size.y<n.size.y?r.addNotification({title:"Слишком большое изображение",message:"Размер изображения больше игрового поля",type:"error"}):l.setImage(n,e.name,new f(0,0))}function u(e){e.preventDefault(),t(!0)}function g(e){e.preventDefault(),t(!1)}return i("div",{class:[E.wrapper,a?E.wrapperActive:""].join(" "),onDrop:function(e){var n;e.preventDefault(),g(e);const a=null==(n=e.dataTransfer)?void 0:n.files;a&&a.length&&o(a[0])},onDragEnter:u,onDragOver:u,onDragLeave:g,children:[i("p",{class:E.label,children:"Перетащите изображение"}),i("p",{class:E.or,children:"или"}),i("input",{type:"file",accept:"image/png",onInput:function(e){e.preventDefault();const n=e.currentTarget.files;n&&n.length&&o(n[0])},ref:n,class:E.input}),i(w,{onClick:()=>{var e;return null==(e=n.current)?void 0:e.click()},children:"Выберите файл"})]})}const K={coordinates:"_coordinates_1cczs_1",groups:"_groups_1cczs_7",group:"_group_1cczs_7",groupTitle:"_groupTitle_1cczs_20",wrapper:"_wrapper_1cczs_28",image:"_image_1cczs_34",imageName:"_imageName_1cczs_40",removeIcon:"_removeIcon_1cczs_49"};function Q(){var n,a;const t=e(d),l=e(m);function c(e,n){const a=t.position.value.clone();a[e]=n,t.position.value=a,t.save()}return i("div",{class:K.wrapper,children:[i("div",{class:K.image,children:[i("p",{class:K.imageName,children:t.imageName}),i(w,{onClick:t.unsetImage,type:"danger",children:i(N,{icon:"plus",className:K.removeIcon})})]}),i("div",{class:K.groups,children:[i("div",{class:K.group,children:[i("p",{class:K.groupTitle,children:"Координаты"}),i("div",{class:K.coordinates,children:[i(j,{min:0,max:null==(n=l.image.value)?void 0:n.size.x,type:"number",placeholder:"X координата",defaultValue:t.position.value.x.toString(),onInput:e=>c("x",parseInt(e))}),i(j,{min:0,max:null==(a=l.image.value)?void 0:a.size.y,type:"number",placeholder:"Y координата",defaultValue:t.position.value.y.toString(),onInput:e=>c("y",parseInt(e))})]})]}),i("div",{class:K.group,children:[i("p",{class:K.groupTitle,children:"Прозрачность"}),i(j,{min:0,max:100,type:"number",placeholder:"Прозрачность",defaultValue:t.opacity.value.toString(),onInput:function(e){t.opacity.value=parseInt(e),t.save()}})]})]})]})}function R(){const n=e(d);return r((()=>{n.load()}),[]),i(k,{title:"Изображение",children:n.isSet.value?i(Q,{}):i(J,{})})}function W(){return i("div",{className:V.sidebar,children:[i(U,{}),i(q,{}),i(R,{}),i(X,{})]})}const Y={wrapper:"_wrapper_157jp_1","scale-down":"_scale-down_157jp_1","scale-up":"_scale-up_157jp_1",content:"_content_157jp_39",title:"_title_157jp_40",params:"_params_157jp_49",media:"_media_157jp_57",icons:"_icons_157jp_82"},G={wrapper:"_wrapper_u7e1h_1",input:"_input_u7e1h_7"};function H(){if(![11,0,1].includes((new Date).getMonth()))return null;const n=e(g);return i("div",{className:G.wrapper,children:[i("input",{type:"checkbox",className:G.input,onChange:function(e){n.settings.value={...n.settings.value,enableSnow:e.target.checked},n.save()},defaultChecked:n.settings.value.enableSnow}),i(N,{icon:"snowflake",alt:"Переключить снег",size:35,viewBoxSize:272})]})}function P(){const n=e(h),a=e(m),[t,l]=c();if(r((()=>{n.fetch(),l(setInterval(n.fetch,o.time.update.info))}),[]),null===n.info.value||null===a.image.value)return null;const s=n.info.value.ended,u="season:blank"===n.info.value.name?"Без названия":n.info.value.name,p=s?"🏁":"⚔️";return i("details",{className:Y.wrapper,children:[i("summary",{className:Y.title,children:[u," ",p]}),i("div",{className:Y.content,children:[i("div",{className:Y.params,children:[i(O,{label:"Кулдаун",value:n.info.value.cooldown+"мс"}),i(O,{label:"Размер",value:a.image.value.size.x+"x"+a.image.value.size.y}),i(O,{label:"Онлайн",value:n.info.value.online.toString()})]}),i("div",{className:Y.icons,children:[i("div",{className:Y.media,children:Object.entries(o.media).map((([e,n])=>i("a",{href:n[0],target:"_blank",rel:"noopener noreferrer",children:i(N,{icon:e,alt:n[1],size:35,viewBoxSize:256})},e)))}),i(H,{})]})]})]})}const Z="_wrapper_udxdq_1";function ee(){return i("div",{className:Z,children:[i(P,{}),i(W,{})]})}export{ee as TopBar};
